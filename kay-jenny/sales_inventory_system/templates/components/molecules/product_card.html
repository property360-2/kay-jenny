{# Product Card Component #}
{# Usage: {% include 'components/molecules/product_card.html' with product=product %} #}

<div class="bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow {{ class }}">
    {% if product.image %}
    <div class="h-48 overflow-hidden bg-gray-100">
        <img src="{{ product.image.url }}" alt="{{ product.name }}" class="w-full h-full object-cover">
    </div>
    {% else %}
    <div class="h-48 bg-gradient-to-br from-fjc-yellow-100 to-fjc-blue-100 flex items-center justify-center">
        <span class="material-icons text-6xl text-gray-400">restaurant</span>
    </div>
    {% endif %}

    <div class="p-4">
        <div class="flex justify-between items-start mb-2">
            <h3 class="text-lg font-semibold text-gray-900">{{ product.name }}</h3>
            <div class="flex gap-2 items-start">
                {% if show_stock %}
                    {% if product.is_low_stock %}
                    {% include 'components/atoms/badge.html' with type='warning' text='Low Stock' icon=True %}
                    {% elif product.stock == 0 %}
                    {% include 'components/atoms/badge.html' with type='danger' text='Out of Stock' %}
                    {% endif %}
                {% endif %}

                {# BOM Recipe Badge #}
                {% if product.recipeitem %}
                <span class="inline-block bg-purple-100 text-purple-800 text-xs font-semibold px-2 py-1 rounded flex items-center gap-1" title="Recipe defined">
                    <span class="material-icons text-base">assignment</span>
                </span>
                {% endif %}
            </div>
        </div>

        {% if product.description %}
        <p class="text-sm text-gray-600 mb-3 line-clamp-2">{{ product.description }}</p>
        {% endif %}

        <div class="flex justify-between items-center mb-3">
            <span class="text-2xl font-bold text-fjc-blue-600">₱{{ product.price }}</span>
            {% if show_stock %}
            <span class="text-sm text-gray-500">Stock: {{ product.stock }}</span>
            {% endif %}
        </div>

        {# BOM Recipe Info #}
        {% if product.recipeitem and product.recipeitem.ingredients.all %}
        <div class="mb-3 p-2 bg-blue-50 rounded-lg border border-blue-200">
            <p class="text-xs font-semibold text-blue-900 mb-1"><span class="material-icons align-middle inline mr-1 text-sm">inventory_2</span> Recipe:</p>
            <div class="text-xs text-blue-800 space-y-1">
                {% for item in product.recipeitem.ingredients.all|slice:":3" %}
                <p>• {{ item.ingredient.name }} <span class="text-blue-600">{{ item.quantity }} {{ item.ingredient.unit }}</span></p>
                {% endfor %}
                {% if product.recipeitem.ingredients.all|length > 3 %}
                <p class="text-blue-600 font-medium">+{{ product.recipeitem.ingredients.all|length|add:"-3" }} more</p>
                {% endif %}
            </div>
        </div>
        {% endif %}

        {% if show_actions %}
        <div class="mt-4 flex space-x-2">
            {% if edit_url %}
            {% include 'components/atoms/button.html' with type='outline' text='Edit' href=edit_url class='flex-1' %}
            {% endif %}
            {% if add_to_cart %}
            <button onclick="addToCart({{ product.id }})" class="flex-1 bg-fjc-yellow-500 text-white px-4 py-2 rounded-lg hover:bg-fjc-yellow-600 font-medium text-sm">
                Add to Cart
            </button>
            {% endif %}
        </div>
        {% endif %}
    </div>
</div>
